<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Minion Casino Test</title>
  <style>
    body {
      font-family: sans-serif;
    }
    #message {
      padding: 1rem;
      background: #eee;
    }
  </style>
  <script>
    const API_BASE = 'http://localhost:3000'; // You can use a proper public URL instead of localhost

    window.addEventListener('DOMContentLoaded', async () => {
      const tg = window.Telegram ? window.Telegram.WebApp : null;
      if (!tg) {
        document.body.innerHTML = '<h3>Please open in Telegram</h3>';
        return;
      }
      tg.ready();

      const userId = tg.initDataUnsafe?.user?.id || 'NOT_AVAILABLE';
      
      try {
          const balanceResult = await fetch(`${API_BASE}/balance?userId=${userId}`);
          const balanceData = await balanceResult.json();
          document.getElementById('message').textContent = `Success! Welcome user ${userId}. Balance: ${balanceData.diamondBalance} points.`;
      } catch(err) {
          console.log(err);
        document.getElementById('message').textContent = 'Error fetching API.';
      }
        console.log('WebApp object loaded');
    });
  </script>
</head>
<body>
<div id="message">Loading...</div>
</body>
</html>
